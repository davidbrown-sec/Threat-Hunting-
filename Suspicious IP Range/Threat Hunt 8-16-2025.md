# Remote Code Execution Hunting Report

## ðŸ“Š Summary of Findings
During advanced hunting, suspicious outbound connections were observed from multiple internal hosts to a concentrated external IP block **208.89.73.[145â€“159]** over **port 80 (HTTP)**.

- **Hosts Involved:** Multiple (`10.x.x.x` ranges)  
- **Processes Observed:**
  - `svchost.exe` (parent: `services.exe`) â†’ dominant, indicates possible malicious service or DLL injection
  - `msedgewebview2.exe` â†’ potential abuse of Edge WebView runtime
  - `mpdefendercoreservice.exe` â†’ single occurrence
- **Accounts Involved:**
  - `NETWORK SERVICE` (service account)
  - `SYSTEM` (system context)
  - User account `<User1>` (example: could represent a standard user)

**Key Concern:** Numerous **successful HTTP connections** (`ConnectionSuccess`, `HttpConnectionInspected`, `ConnectionAcknowledged`) confirm **active C2 traffic**, not just blocked attempts.

---

## ðŸ”Ž MITRE ATT&CK Mapping

| Tactic                  | Technique                                                        | Notes |
|--------------------------|------------------------------------------------------------------|-------|
| **Execution**           | T1059 â€“ Command & Scripting Interpreter (PowerShell)             | Earlier events included PowerShell-initiated connections |
| **Persistence**         | T1543 â€“ Create/Modify System Process (svchost abuse)             | Traffic generated by `svchost.exe` launched via `services.exe` |
| **Privilege Escalation**| T1055 â€“ Process Injection                                        | Likely injection into `svchost.exe` |
| **Defense Evasion**     | T1218 â€“ Signed Binary Proxy Execution (LOLBins)                  | Abuse of `msedgewebview2.exe` runtime |
| **Command & Control**   | T1071.001 â€“ Application Layer Protocol: Web (HTTP/S)             | Repeated HTTP beaconing to suspicious subnet |
| **Discovery**           | T1018 â€“ Remote System Discovery                                 | Internal probing of private 10.x.x.x addresses in earlier datasets |
| **Lateral Movement**    | T1021 â€“ Remote Services                                         | Evidence of attempted internal connections |

---

## ðŸ“… Timeline of Activity
- **Aug 9, 2025 ~21:00** â†’ First major spike (53+ connections in 1 hour)  
- **Aug 9â€“10, 2025** â†’ Sustained outbound HTTP sessions  
- **Ongoing** â†’ Beacons from multiple hosts using SYSTEM and service accounts  

---

## ðŸ›  Next Steps (NIST IR Framework)

### 1. Preparation
- Verify incident response playbooks cover service-hosted persistence and C2 over HTTP
- Confirm log collection for **4688 (Process Creation)**, **4104 (PowerShell)**, **7045 (Service Installations)**

### 2. Detection & Analysis
- Correlate `FirstSeen` / `LastSeen` times with Windows logs
- Collect `InitiatingProcessSHA256` hashes for threat intelligence enrichment
- Inspect command-line arguments for LOLBins (`svchost.exe`, `msedgewebview2.exe`)

### 3. Containment
- Block **208.89.73.0/24** at network egress
- Isolate affected devices (e.g., `10.x.x.x` hosts seen in logs)
- Revoke credentials and sessions for `<User1>` (compromised account)

### 4. Eradication
- Remove malicious services or injected DLLs tied to `svchost.exe`
- Inspect persistence mechanisms (Scheduled Tasks, Run keys, Services)
- Conduct memory capture and forensic review of at least one infected endpoint

### 5. Recovery
- Reimage systems where integrity cannot be assured
- Monitor closely for re-infection or new outbound traffic anomalies

### 6. Lessons Learned
- Strengthen egress filtering for unusual HTTP destinations
- Expand hunting queries to include process details, accounts, URLs, and TI joins
- Improve detection logic for `svchost.exe` network traffic anomalies


## ðŸ“‘ Supporting Evidence

### VirusTotal Reputation
![VT result clean](https://github.com/davidbrown-sec/Threat-Hunting-/blob/6d08e13b31dd8339dc59a7c62954730bb93e5030/Suspicious%20IP%20Range/Virustotalesultclean.png)  
*208.89.73.149 marked clean by vendors*

![VT result flagged](https://github.com/davidbrown-sec/Threat-Hunting-/blob/4b583bb471a982ce4cbfd1d1d1c45cd10004682f/Suspicious%20IP%20Range/VirustotalResultNotClean.png)  
*208.89.73.157 flagged as malicious by CRDF, suspicious by SOC Radar/Gridinsoft*

### Hunting Query Results
![Connection logs](https://github.com/davidbrown-sec/Threat-Hunting-/blob/1c9110a6d87441cf00f405d73b2b29873cb15822/Suspicious%20IP%20Range/recentoccurancefoundsanatize.png)
*Sample of raw hunting results showing failed and successful connections from internal hosts (`10.x.x.x`)*

### Timeline of Activity
![Graph view](https://github.com/davidbrown-sec/Threat-Hunting-/blob/e9b4891512474f4d60b9eae63dfe3649a87f956b/Suspicious%20IP%20Range/timeline.png)  
*Visual representation of connection outcomes across time*

### Aggregated Statistics
![Summary stats](https://github.com/davidbrown-sec/Threat-Hunting-/blob/29b0839252cc76e2b311b750a848a27a85967515/Suspicious%20IP%20Range/statistics.png)  
*Total connections, failures vs successes, distinct remote and local IPs*


---

## ðŸš© Key Takeaways
- Multiple hosts beaconed successfully to an external IP range
- Traffic originated from **SYSTEM and service contexts**, with at least one compromised user (`<User1>`)
- Persistence likely achieved through **malicious service creation or process injection**
- Immediate blocking, host isolation, and forensic triage are recommended.
